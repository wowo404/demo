//created on: 2017-5-10
package com.sample.left

//list any import classes here.
import com.sample.com.sample.mdl.School;
import com.sample.com.sample.mdl.Student;
import com.sample.com.sample.enums.AnimalEnum;
import com.sample.com.sample.mdl.Teacher;
import com.sample.com.sample.mdl.Order
import com.sample.mdl.OrderItcom.sample.mdl.OrderItemva.util.ArrayList;

//declare any global variables here




rule "test LHS"
    when
        School($schoolName : name);
        Student(name in ("�챦","ɽ��",$schoolName));
        Student(name not in ("�Ű�","ħЫ",$schoolName));
        Student(AnimalEnum.LION.index == index);
        Student(school.name == "����");
        not Teacher();
        not Student(age == 50);
        exists Student(age == 100);
    then
        System.out.println("success to use: �󶨱�����$schoolName=" + $schoolName);
        System.out.println("success to use: in and not in");
        System.out.println("success to use: �����ͱ����ıȽ�");
        System.out.println("success to use: not and exists");

end

rule "use from"
    when
        $st:Student();
        $s:School(name == "����") from $st.school;
    then
        $s.setStudentNumber($s.getStudentNumber() + 1);
        drools.modify($s);
        $st.setBeCounted(1);
        drools.modify($st);
        System.out.println("success to use: from,school's student number=" + $s.getStudentNumber() + ",school name=" + $s.getName());
		System.out.println("student name is=" + $st.getName() + ",beCounted=" + $st.getBeCounted());
end

rule "use from with collect"
    when
        //δ���Գɹ�
    	//$st:Student();
        //school:ArrayList(size >= 2);
        //from collect(School(name == "����") from $st.school);
    then
        //System.out.println("success to use collect: student[0] name="$students[0].getName());
end

rule "use accumulate"
    when
    	accumulate(Student($age:age);$min:min($age),$max:max($age),$avg:average($age),
    		$count:count($age),$sum:sum($age),
    		$collectList:collectList($age),$collectSet:collectSet($age)
    	)
    then
        System.out.printf("success to use accumulate: min=%s,max=%s,avg=%s,count=%s,sum=%s,collectList=%s,collectSet=%s",$min,$max,$avg,$count,$sum,$collectList,$collectSet);
        System.out.println();
end

rule "use accumulate inline code"
	when
	    $order : Order()
	    $total : Number( doubleValue > 100 )
	             from accumulate( OrderItem( order == $order, $value : value ),
	                              init( double total = 0; ),
	                              action( total += $value; ),
	                              reverse( total -= $value; ),
	                              result( total ) )
	then
	    System.out.println("success use accumulate inline code,total=" + $total);
end
